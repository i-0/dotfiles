#+TITLE: Experimental configuration and plugins
#+OPTIONS: toc:nil ^:nil

* Helm
As per http://tuhdo.github.io/helm-intro.html, alternative approach
here:
https://dl.dropboxusercontent.com/u/3968124/sacha-emacs.html#unnumbered-14

#+BEGIN_SRC emacs-lisp
  (require 'helm)
  (require 'helm-config)
  ;; The default "C-x c" is quite close to "C-x C-c", which quits Emacs.
  ;; Changed to "C-c h". Note: We must set "C-c h" globally, because we
  ;; cannot change `helm-command-prefix-key' once `helm-config' is loaded.
  (global-set-key (kbd "C-c h") 'helm-command-prefix)
  (global-unset-key (kbd "C-x c"))

  (define-key helm-map (kbd "<tab>") 'helm-execute-persistent-action) ; rebind tab to run persistent action
  (define-key helm-map (kbd "C-i") 'helm-execute-persistent-action) ; make TAB works in terminal
  (define-key helm-map (kbd "C-z")  'helm-select-action) ; list actions using C-z


  (when (executable-find "curl")
    (setq helm-google-suggest-use-curl-p t))

  (setq helm-split-window-in-side-p           t ; open helm buffer inside current window, not occupy whole other window
	helm-move-to-line-cycle-in-source     t ; move to end or beginning of source when reaching top or bottom of source.
	helm-ff-search-library-in-sexp        t ; search for library in `require' and `declare-function' sexp.
	helm-scroll-amount                    8 ; scroll 8 lines other window using M-<next>/M-<prior>
	helm-ff-file-name-history-use-recentf t)

  (helm-mode 1)
  (ido-mode -1) ;; Turn off ido mode just in case
#+END_SRC


* Projectile

| shortcut | function             | effect                                 |
| /        | <>                   |                                        |
|----------+----------------------+----------------------------------------|
| C-c p f  | projectile-find-file | opens file within project (using helm) |

** projectile everywhere!
#+BEGIN_SRC emacs-lisp
  (projectile-global-mode)
#+END_SRC

** Use helm with projectile
#+BEGIN_SRC emacs-lisp
  (setq projectile-completion-system 'helm)
  (helm-projectile-on)
#+END_SRC


* git integration
From: http://magit.vc
#+BEGIN_SRC emacs-lisp
(global-set-key (kbd "C-x g") 'magit-status)
(global-set-key (kbd "C-x M-g") 'magit-dispatch-popup)
#+END_SRC


* j2s-mode javascript "IDE"
from: https://truongtx.me/2014/02/23/set-up-javascript-development-environment-in-emacs
#+BEGIN_SRC emacs-lisp
  (add-to-list 'auto-mode-alist '("\\.js\\'" . js2-mode))
  (add-hook 'js-mode-hook 'js2-minor-mode)
  (add-hook 'js2-mode-hook 'ac-js2-mode)
  (setq js2-highlight-level 3)
#+END_SRC


* org-mode
** babel
#+BEGIN_SRC emacs-lisp
  (org-babel-do-load-languages
   'org-babel-load-languages
   '((plantuml . t)
     (dot . t)
     (sql . t)
     (python . t)
     (gnuplot . t)
     (clojure .t)
     (R . t)))
#+END_SRC
*** plantuml integration
Allows plantuml-mode when using C-c ' to edit the src block.

#+BEGIN_SRC emacs-lisp
  (add-to-list 'org-src-lang-modes (quote ("plantuml" . plantuml)))
  (setq org-plantuml-jar-path (expand-file-name "~/Applications/plantuml.jar"))
  (setq org-src-fontify-natively t)
#+END_SRC

*** define for which langs babel asks for confirmation before executing code
The following langs are whitelisted to skip tedious questions:
- dot
- plantuml
#+BEGIN_SRC emacs-lisp
(defun my-org-confirm-babel-evaluate (lang body)
  (not (or (string= lang "plantuml")
	   (string= lang "dot"))))
      
(setq org-confirm-babel-evaluate 'my-org-confirm-babel-evaluate)
#+END_SRC
#+RESULTS:
: my-org-confirm-babel-evaluate


** skeletons
#+BEGIN_SRC emacs-lisp
(define-skeleton org-skeleton
  "Header info for a emacs-org file."
  "Title: "
  "#+TITLE: " str "\n"
  "#+AUTHOR: Christoph Gierling\n"
  "#+EMAIL: christioph.gierling@docomodigital.com\n"
  "#+OPTIONS: num:nil ^:nil author:nil html-postamble:nil toc:nil\n")
(global-set-key [C-S-f4] 'org-skeleton)
#+END_SRC

This skeleton prompts for the JIRA
card URL and generates the org-mode
headers.
#+BEGIN_SRC emacs-lisp
  (define-skeleton org-jira-card-skeleton
    "Header info for a emacs-org jira card file."
    "Title: "
    "#+TITLE: [[" str "]["(last (split-string str "/"))"]]\n"
    "#+AUTHOR: Christoph Gierling\n"
    "#+EMAIL: christioph.gierling@buongiorno.com\n"
    "#+OPTIONS: num:nil ^:nil author:nil html-postamble:nil toc:nil\n"
    "\n"
    "* Issue\n\n"
    "* RCA\n\n"
    "* Solution\n\n"
    "* Misc\n")

  (global-set-key [C-S-f3] 'org-skeleton)
#+END_SRC

* TODO anzu with evil integration
Seems to be of utility when refactoring names.

From: https://github.com/syohex/emacs-anzu
With: https://github.com/syohex/emacs-evil-anzu


* misc UI improvements
** Show tooltips in echo area
From mastering emacs: http://www.masteringemacs.org/article/making-tooltips-appear-in-echo-area
#+BEGIN_SRC emacs-lisp
(tooltip-mode -1)
(setq tooltip-use-echo-area t)
#+END_SRC

** Simplify confirmation dialogs from "yes/no" to "y/n"
#+BEGIN_SRC emacs-lisp
(fset 'yes-or-no-l 'y-or-n-p)
#+END_SRC


* Change flyspell dictionary on the fly                                :cool:
from: http://www.emacswiki.org/emacs/FlySpell
**** TODO possible features
- on (english), on (spanish), on (deutsch8), off << default mode on -> flyspell-mode
**** usage
1. Start flyspell-mode
2. Now you can cycle pressing [F6] through languages english, german and spanish

#+BEGIN_SRC emacs-lisp
(let ((langs '("english" "deutsch8" "espanol")))
  (setq lang-ring (make-ring (length langs)))
  (dolist (elem langs) (ring-insert lang-ring elem)))

(defun cycle-ispell-languages ()
  (interactive)
  (let ((lang (ring-ref lang-ring -1)))
    (ring-insert lang-ring lang)
    (ispell-change-dictionary lang)))

(global-set-key [f6] 'cycle-ispell-languages)
#+END_SRC

#+RESULTS:
: cycle-ispell-languages

* Clojure setup

** TODO cider
#+BEGIN_SRC emacs-lisp
    ;; provides minibuffer documentation for the code you're typing into the repl
    (add-hook 'cider-mode-hook 'cider-turn-on-eldoc-mode)

    ;; go right to the REPL buffer when it's finished connecting
    (setq cider-repl-pop-to-buffer-on-connect t)

    ;; When there's a cider error, show its buffer and switch to it
    (setq cider-show-error-buffer t)
    (setq cider-auto-select-error-buffer t)
    ;; When in cider-error buffer default to emacs mode
    (evil-set-initial-state 'cider-stacktrace-mode 'emacs)

    ;; Where to store the cider history.
    (setq cider-repl-history-file "~/.emacs.d/cider-history")

    ;; Wrap when navigating history.
    (setq cider-repl-wrap-history t)

    ;; enable paredit in your REPL
    (add-hook 'cider-repl-mode-hook 'paredit-mode)

    ;; Use clojure mode for other extensions
    (add-to-list 'auto-mode-alist '("\\.edn$" . clojure-mode))
    (add-to-list 'auto-mode-alist '("\\.boot$" . clojure-mode))
    (add-to-list 'auto-mode-alist '("\\.cljs.*$" . clojure-mode))
    (add-to-list 'auto-mode-alist '("lein-env" . enh-ruby-mode))


    ;; key bindings
    ;; these help me out with the way I usually develop web apps
    (defun cider-start-http-server ()
      (interactive)
      (cider-load-current-buffer)
      (let ((ns (cider-current-ns)))
	(cider-repl-set-ns ns)
	(cider-interactive-eval (format "(println '(def server (%s/start))) (println 'server)" ns))
	(cider-interactive-eval (format "(def server (%s/start)) (println server)" ns))))


    (defun cider-refresh ()
      (interactive)
      (cider-interactive-eval (format "(user/reset)")))

    (defun cider-user-ns ()
      (interactive)
      (cider-repl-set-ns "user"))

    (eval-after-load 'cider
      '(progn
	 (define-key clojure-mode-map (kbd "C-c C-v") 'cider-start-http-server)
	 (define-key clojure-mode-map (kbd "C-M-r") 'cider-refresh)
	 (define-key clojure-mode-map (kbd "C-c u") 'cider-user-ns)
	 (define-key cider-mode-map (kbd "C-c u") 'cider-user-ns)))
#+END_SRC

** misc
#+BEGIN_SRC emacs-lisp
  ;; Enable paredit for Clojure
  (add-hook 'clojure-mode-hook 'enable-paredit-mode)

  ;; This is useful for working with camel-case tokens, like names of
  ;; Java classes (e.g. JavaClassName)
  (add-hook 'clojure-mode-hook 'subword-mode)

  ;; A little more syntax highlighting
  (require 'clojure-mode-extra-font-locking)

  ;; syntax hilighting for midje
  (add-hook 'clojure-mode-hook
	    (lambda ()
	      (setq inferior-lisp-program "lein repl")
	      (font-lock-add-keywords
	       nil
	       '(("(\\(facts?\\)"
		  (1 font-lock-keyword-face))
		 ("(\\(background?\\)"
		  (1 font-lock-keyword-face))))
	      (define-clojure-indent (fact 1))
	      (define-clojure-indent (facts 1))))
#+END_SRC


** org-mode babel

* UI
#+BEGIN_SRC emacs-lisp
  ;; Highlights matching parenthesis
  (show-paren-mode 1)

  ;; Highlight current line
  (global-hl-line-mode 1)
#+END_SRC

* SQL
from: https://truongtx.me/2014/08/23/setup-emacs-as-an-sql-database-client
To connect use sql-connect function and interactively choose DB.
#+BEGIN_SRC emacs-lisp
  (setq sql-connection-alist
        '((jmailer_gr
           (sql-product 'mysql)
           (sql-server "10.1.16.36")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_gr"))
	  (jmailer_tr
	   (sql-product 'mysql)
           (sql-server "10.1.16.36")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_tr"))
          (jmailer_eg
           (sql-product 'mysql)
           (sql-server "10.1.16.36")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_eg"))
          (jmailer_id
           (sql-product 'mysql)
           (sql-server "10.1.16.37")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_id"))
          (jmailer_in
           (sql-product 'mysql)
           (sql-server "10.1.16.28")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_in"))
          (jmailer_kw
           (sql-product 'mysql)
           (sql-server "10.1.16.36")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_kw"))
          (jmailer_ph
           (sql-product 'mysql)
           (sql-server "10.1.16.37")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_ph"))
          (jmailer_th
           (sql-product 'mysql)
           (sql-server "10.1.16.36")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_th"))
          (jmailer_ru
           (sql-product 'mysql)
           (sql-server "10.1.7.118")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_ru"))
          (jmailer_ch
           (sql-product 'mysql)
           (sql-server "10.1.7.111")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_ch"))
          (jmailer_it
           (sql-product 'mysql)
           (sql-server "10.1.7.111")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_it"))
          (jmailer_at
           (sql-product 'mysql)
           (sql-server "10.1.16.17")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_at"))
          (jmailer_de
           (sql-product 'mysql)
           (sql-server "10.1.16.17")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_de"))
          (jmailer_fr
           (sql-product 'mysql)
           (sql-server "10.1.16.16")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_fr"))
          (jmailer_ml
           (sql-product 'mysql)
           (sql-server "10.1.16.16")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_ml"))
          (jmailer_ci
           (sql-product 'mysql)
           (sql-server "10.1.16.16")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_ci"))
          (jmailer_gq
           (sql-product 'mysql)
           (sql-server "10.1.16.16")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_gq"))
          (jmailer_sn
           (sql-product 'mysql)
           (sql-server "10.1.16.16")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_sn"))
          (jmailer_ma
           (sql-product 'mysql)
           (sql-server "10.1.16.16")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_ma"))
          (jmailer_es
           (sql-product 'mysql)
           (sql-server "10.1.7.113")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_es"))
          (jmailer_mex
           (sql-product 'mysql)
           (sql-server "10.1.16.13")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_mex"))
          (jmailer_cl
           (sql-product 'mysql)
           (sql-server "10.1.16.12")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_cl"))
          (jmailer_col
           (sql-product 'mysql)
           (sql-server "10.1.16.12")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_col"))
          (jmailer_inter
           (sql-product 'mysql)
           (sql-server "10.1.16.19")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_inter"))
          (jmailer_usa
           (sql-product 'mysql)
           (sql-server "10.1.7.217")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_usa"))
          (jmailer_ca
           (sql-product 'mysql)
           (sql-server "10.1.7.217")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_ca"))
          (jmailer_au
           (sql-product 'mysql)
           (sql-server "10.1.7.117")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_au"))
          (jmailer_nz
           (sql-product 'mysql)
           (sql-server "10.1.7.117")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_nz"))
          (jmailer_uk
           (sql-product 'mysql)
           (sql-server "10.1.16.6")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_uk"))
          (jmailer_nl
           (sql-product 'mysql)
           (sql-server "10.1.16.6")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_nl"))
          (jmailer_be
           (sql-product 'mysql)
           (sql-server "10.1.16.6")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_be"))
          (jmailer_ec
           (sql-product 'mysql)
           (sql-server "10.1.16.12")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_ec"))
          (jmailer_bra
           (sql-product 'mysql)
           (sql-server "10.1.7.16")
           (sql-port "3302")
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_bra"))
          (jmailer_ar
           (sql-product 'mysql)
           (sql-server "10.1.16.12")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_ar"))
          (jmailer_ie
           (sql-product 'mysql)
           (sql-server "10.1.7.124")
           (sql-port "3308")
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_ie"))
          (jmailer_ve
           (sql-product 'mysql)
           (sql-server "10.1.16.12")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_ve"))
          (jmailer_latam
           (sql-product 'mysql)
           (sql-server "10.1.16.12")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_latam"))
          (jmailer_za
           (sql-product 'mysql)
           (sql-server "10.1.7.117")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_za"))
          (jmailer_ng
           (sql-product 'mysql)
           (sql-server "10.1.16.19")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_ng"))
          (jmailer_afr
           (sql-product 'mysql)
           (sql-server "10.1.16.14")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_afr"))
          (jmailer_cz
           (sql-product 'mysql)
           (sql-server "10.1.16.14")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_cz"))
          (jmailer_hu
           (sql-product 'mysql)
           (sql-server "10.1.16.14")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_hu"))
          (jmailer_ro
           (sql-product 'mysql)
           (sql-server "10.1.16.14")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_ro"))
          (jmailer_pt
           (sql-product 'mysql)
           (sql-server "10.1.16.30")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_br"))
          (mobivillage
           (sql-product 'mysql)
           (sql-server "mvcoretools.rep.buongiorno.com")
           (sql-port "3306")
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database ""))
          (jmailer_sfr
           (sql-product 'mysql)
           (sql-server "10.1.16.38")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_sfr"))
          (cat.services
           (sql-product 'mysql)
           (sql-server "10.1.16.56")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "cat_stats_services"))
          (cat.reporting
           (sql-product 'mysql)
           (sql-server "10.1.16.56")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "cat_stats_reporting"))
          (jmailer_vip
           (sql-product 'mysql)
           (sql-server "10.1.16.2")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_vip"))
          (jmailer_no
           (sql-product 'mysql)
           (sql-server "jmailer_no.repstats.buongiorno.com")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_no"))
          (jmailer_cashloges
           (sql-product 'mysql)
           (sql-server "jmailer_cashloges.buongiorno.com")
           (sql-port "3306")
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_cashloges"))
          (jmailer_my
           (sql-product 'mysql)
           (sql-server "10.1.16.11")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_my"))
          (jmailer_sg
           (sql-product 'mysql)
           (sql-server "jmailer_sg.rep.buongiorno.com")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_sg"))
          (jmailer_jp
           (sql-product 'mysql)
           (sql-server "jmailer_jpdb.rep.buongiorno.com")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_jp"))
          (jmailer_ph
           (sql-product 'mysql)
           (sql-server "jmailer_phdb.rep.buongiorno.com")
           (sql-port 3301)
           (sql-user "tech")
           (sql-password "mf15mdj")
           (sql-database "jmailer_ph"))))
#+END_SRC

* eclimd
from: http://www.goldsborough.me/emacs,/java/2016/02/24/22-54-16-setting_up_emacs_for_java_development/
from: http://eclim.org/install.html

Enable eclim for java files.
#+BEGIN_SRC emacs-lisp
(custom-set-variables
  '(eclim-eclipse-dirs '("~/Applications/eclipse"))
  '(eclim-executable "~/Applications/eclipse/eclim"))
  '(eclimd-executable "~/Applications/eclipse/eclimd"))

(require 'eclim)
(add-hook 'java-mode-hook' 'eclim-mode)
#+END_SRC


* smart-tab-mode (indent with tabs and align with spaces)
#+BEGIN_SRC emacs-lisp
;;(smart-tabs-insinuate 'java)
#+END_SRC

